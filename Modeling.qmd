# Modeling Quarto File

> This is the Modeling file which will be used to construct and evaluate different model fits for predictive modeling of Diabetes Health Indicators.

> Start by activiting the necessary packages

```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
library(caret)
library(ranger)
```

> Partition the data set into training & test sets

```{r}
set.seed(90)
trainIndex <- createDataPartition(diab2$DiabetesStatus, p = 0.7, list = FALSE)
diabTrain <- diab2[trainIndex, ]
diabTest <- diab2[-trainIndex, ]
```

> Begin modeling:

> Create the training object

```{r}
trctrl <- trainControl(method = "cv", number = 5, classProbs = TRUE,
                       summaryFunction = mnLogLoss)
set.seed(56)
```

### Logistic Regression Models

> Starting with a model only dependent upon age

```{r}
(glmFit1 <- train(DiabetesStatus ~ Age,
                 data = diabTrain,
                 method = "glm",
                 metric = "logLoss",
                 trControl=trctrl))
```

> Next use a model incorporating age & BMI:

```{r}
(glmFit2 <- train(DiabetesStatus ~ Age*BMI,
                 data = diabTrain,
                 method = "glm",
                 metric = "logLoss",
                 trControl=trctrl))
```

> Finally, a model incorporating Education, Income, and their interaction effects:

```{r}
(glmFit3 <- train(DiabetesStatus ~ Education*Income,
                 data = diabTrain,
                 method = "glm",
                 metric = "logLoss",
                 trControl=trctrl))
```

### Classification Tree

```{r}
(treeFit1 <- train(DiabetesStatus ~ .,
                  data = diab2,
                  method = "rpart",
                  trControl=trctrl,
                  preProcess = c("center", "scale"),
                  tuneGrid = data.frame(cp = seq(0, 0.1, by = 0.01)),
                  metric = "logLoss"))
```

### Random Forest

```{r}
(treeFit2 <- train(DiabetesStatus ~ .,
                  data = diab2,
                  method = "ranger",
                  trControl=trctrl,
                  preProcess = c("center", "scale"),
                  metric = "logLoss",
                  tuneLength = 3))
```



### Link to EDA Site:

[Click here for the EDA Page](EDA.html)